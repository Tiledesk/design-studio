:host{
    $margin-left: 10px;
    $padding: 10px; 
    --panel-width: 480px;
}

.row {
    margin: 0 0 10px;
    padding: 20px 24px; 
}

.panel-note-detail {
    display: flex;
    flex-direction: column;
    width: var(--panel-width);
    min-width: 400px;
    height: 100%;
    max-height: 100%;
    overflow: hidden;
    padding: 0;
    background-color: white;
    border-left: 1px solid var(--gray-light-02);
    inset: 0 0 0 200px;
    &.minimize {
        --panel-width: 480px;
    }
    &.maximize {
        --panel-width: 680px;
    }
}

.header-panel {
    position: sticky;
    top: 0;
    left: 0;
    right: 0;
    background-color: var(--blu-light-03);
    z-index: 2;
    padding: 0 0 10px 10px;
    display: flex;
    align-items: center;
    justify-content: space-between;

    .pic-title-text {
        display: flex;
        align-items: center;
        width: 100%;
        
        .note-icon {
            margin-right: 10px;
            .material-icons {
                color: var(--blu);
                font-size: 24px;
            }
        }
        
        .title-text {
            h3 {
                margin: 0;
                font-size: 16px;
                font-weight: 500;
                color: var(--blu);
            }
        }
    }
}

.header-options-wrp,
.header-menu-wrp,
.header-close-wrp {
    display: flex;
    padding: 10px;
    cursor: pointer;
    
    .active-icon {
        width: 20px;
        height: 20px;
    }
}

.content-panel {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 20px;
    min-height: 0; // Necessario per far funzionare il flex con overflow
    
    // Stile della scrollbar per coerenza con altri pannelli
    &::-webkit-scrollbar {
        width: 8px;
    }
    
    &::-webkit-scrollbar-track {
        background-color: transparent;
    }
    
    &::-webkit-scrollbar-thumb {
        background-color: rgba(0, 0, 0, 0.2);
        border-radius: 4px;
        
        &:hover {
            background-color: rgba(0, 0, 0, 0.3);
        }
    }
    
    // Per Firefox
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
}

// ---------------------------------------------------------------------------
// IMAGE NOTE UI (no section-title)
// ---------------------------------------------------------------------------
.image-note-section {
    padding: 20px 24px;
}

.image-upload-box {
    border: 2px dashed var(--gray-02);
    border-radius: 8px;
    padding: 16px;
    background: #fff;
}

.image-upload-hint {
    font-size: 14px;
    color: var(--blu);
    font-family: var(--font-family-poppins);
    margin-bottom: 12px;
    text-align: center;
}

.image-upload-error {
    margin-top: 10px;
    font-size: 12px;
    color: #e22828;
    font-family: var(--font-family-poppins);
    line-height: 1.3;
}

.image-file-input {
    display: none;
}

.image-upload-actions {
    display: flex;
    gap: 10px;
    margin-bottom: 12px;
    justify-content: center;
}

.image-url-row {
    display: flex;
    gap: 10px;
    align-items: center;
}

.image-url-input {
    flex: 1;
    height: 34px;
    border: 2px solid var(--gray-02);
    border-radius: 8px;
    padding: 0 10px;
    font-size: 12px;
    font-family: var(--font-family-poppins);
    outline: none;
}

.image-btn {
    height: 34px;
    border-radius: 8px;
    padding: 0 12px;
    border: 2px solid var(--gray-02);
    background: white;
    color: var(--blu);
    font-size: 12px;
    font-family: var(--font-family-poppins);
    cursor: pointer;
}

.image-btn.danger {
    color: #e22828;
}

.image-preview-box {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.image-preview-frame {
    width: 100%;
    height: 220px; // dimensione fissa richiesta
    border-radius: 8px;
    border: none; // richiesto: niente bordo sul div anteprima
    background: transparent;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.image-preview-placeholder {
    position: absolute;
    inset: 0;
    background: #f3f4f6; // grigio chiaro
}

.image-preview {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: contain;
    position: relative;
    z-index: 1;
}

.image-preview.video-preview {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

.image-dimensions-hint {
    font-size: 12px;
    color: var(--blu);
    font-family: var(--font-family-poppins);
}

.image-dimensions {
    font-size: 12px;
    color: var(--blu);
    font-family: var(--font-family-poppins);
    border: 2px solid var(--gray-02);
    padding: 6px;
    border-radius: 8px;
    background: #fff;
}

.image-buttons {
    display: flex;
    gap: 10px;
}

// Rich Text Editor Section
.rich-text-editor-section {
    .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
        
        .section-title {
            margin: 0;
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-dark);
        }
        
        .more-options-icon,
        .collapse-icon {
            width: 18px;
            height: 18px;
            color: var(--gray-dark);
            cursor: pointer;
        }
    }
    
    .rich-text-toolbar {
        display: flex;
        align-items: center;
        gap: 0;
        margin-bottom: 15px;
        padding: 4px;
        border: 1px solid var(--gray-light-02);
        border-radius: 4px;
        background-color: #f9f9f9;
        
        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 0;
        }
        
        .toolbar-separator {
            width: 1px;
            height: 24px;
            background-color: var(--gray-light-02);
            margin: 0 4px;
        }
        
        .toolbar-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            padding: 0;
            border: none;
            background-color: transparent;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
            
            mat-icon {
                width: 18px;
                height: 18px;
                font-size: 18px;
                color: var(--gray-dark);
            }
            
            .format-icon {
                font-size: 14px;
                font-weight: 600;
                font-style: normal;
                color: var(--gray-dark);
                
                &.bold {
                    font-weight: 700;
                }
                
                &.italic {
                    font-style: italic;
                }
                
                &.underline {
                    text-decoration: underline;
                }
            }
            
            .toolbar-color-picker {
                width: 32px;
                height: 32px;
                border: 1px solid var(--gray-light-02);
                border-radius: 4px;
                cursor: pointer;
                padding: 0;
                background: transparent;
                
                &::-webkit-color-swatch-wrapper {
                    padding: 0;
                }
                
                &::-webkit-color-swatch {
                    border: none;
                    border-radius: 3px;
                }
            }
            
            &:hover {
                background-color: rgba(0, 108, 255, 0.1);
            }
            
            &.active {
                background-color: rgba(0, 108, 255, 0.2);
                
                mat-icon,
                .format-icon {
                    color: var(--blu);
                }
            }
        }
    }
    
    // Stili per Quill Editor
    ::ng-deep quill-editor {
        display: block;
        margin-top: 15px;
        margin: 0;
        padding: 0;
        .ql-container {
            font-family: 'Open Sans', sans-serif;
            font-size: 14px;
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
        }
        
        .ql-toolbar {
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border: 1px solid var(--gray-light-02);
            border-bottom: none;
            background-color: var(--blu-light-03);
        }
        
        .ql-container {
            border: 1px solid var(--gray-light-02);
            border-top: none;
        }
        
        .ql-editor {
            min-height: 100px;
            padding: 12px;
            margin: 0;
            color: #000000; // Colore di default del testo
        }

        /* Quill pickers: our tokens are hex without '#', so we paint swatches via CSS. */
        .ql-snow {
            .ql-picker.ql-color,
            .ql-picker.ql-background {
                .ql-picker-item[data-value="000000"] { background-color: #000000; }
                .ql-picker-item[data-value="e60000"] { background-color: #e60000; }
                .ql-picker-item[data-value="ff9900"] { background-color: #ff9900; }
                .ql-picker-item[data-value="ffff00"] { background-color: #ffff00; }
                .ql-picker-item[data-value="008a00"] { background-color: #008a00; }
                .ql-picker-item[data-value="0066cc"] { background-color: #0066cc; }
                .ql-picker-item[data-value="9933ff"] { background-color: #9933ff; }
                .ql-picker-item[data-value="ffffff"] { background-color: #ffffff; border: 1px solid #ddd; }
                .ql-picker-item[data-value="facccc"] { background-color: #facccc; }
                .ql-picker-item[data-value="ffebcc"] { background-color: #ffebcc; }
                .ql-picker-item[data-value="ffffcc"] { background-color: #ffffcc; }
                .ql-picker-item[data-value="cce8cc"] { background-color: #cce8cc; }
                .ql-picker-item[data-value="cce0f5"] { background-color: #cce0f5; }
                .ql-picker-item[data-value="ebd6ff"] { background-color: #ebd6ff; }
                .ql-picker-item[data-value="bbbbbb"] { background-color: #bbbbbb; }
                .ql-picker-item[data-value="f06666"] { background-color: #f06666; }
                .ql-picker-item[data-value="ffc266"] { background-color: #ffc266; }
                .ql-picker-item[data-value="ffff66"] { background-color: #ffff66; }
                .ql-picker-item[data-value="66b966"] { background-color: #66b966; }
                .ql-picker-item[data-value="66a3e0"] { background-color: #66a3e0; }
                .ql-picker-item[data-value="c285ff"] { background-color: #c285ff; }
                .ql-picker-item[data-value="888888"] { background-color: #888888; }
                .ql-picker-item[data-value="a10000"] { background-color: #a10000; }
                .ql-picker-item[data-value="b26b00"] { background-color: #b26b00; }
                .ql-picker-item[data-value="b2b200"] { background-color: #b2b200; }
                .ql-picker-item[data-value="006100"] { background-color: #006100; }
                .ql-picker-item[data-value="0047b2"] { background-color: #0047b2; }
                .ql-picker-item[data-value="6b24b2"] { background-color: #6b24b2; }
                .ql-picker-item[data-value="444444"] { background-color: #444444; }
                .ql-picker-item[data-value="5c0000"] { background-color: #5c0000; }
                .ql-picker-item[data-value="663d00"] { background-color: #663d00; }
                .ql-picker-item[data-value="666600"] { background-color: #666600; }
                .ql-picker-item[data-value="003700"] { background-color: #003700; }
                .ql-picker-item[data-value="002966"] { background-color: #002966; }
                .ql-picker-item[data-value="3d1466"] { background-color: #3d1466; }
            }
        }
    }

    .rich-text-editor-wrapper {
        margin-top: 15px;
        border: 1px solid var(--gray-light-02);
        border-radius: 4px;
        background-color: white;
        min-height: 200px;
        
        .rich-text-editor {
            min-height: 200px;
            padding: 12px;
            outline: none;
            overflow-y: auto;
            word-wrap: break-word;
            white-space: pre-wrap;
            
            &:focus {
                border-color: var(--blu);
            }
            
            // Stili per elementi HTML formattati
            ::ng-deep strong,
            ::ng-deep b {
                font-weight: bold;
            }
            
            ::ng-deep em,
            ::ng-deep i {
                font-style: italic;
            }
            
            ::ng-deep u {
                text-decoration: underline;
            }
            
            ::ng-deep a {
                color: var(--blu);
                text-decoration: underline;
                cursor: pointer;
                
                &:hover {
                    color: var(--blu-dark);
                }
            }
            
            // Quando Ã¨ vuoto, mostra un placeholder
            &:empty:before {
                content: 'Type something...';
                color: #999;
                pointer-events: none;
            }
        }
    }
    
    .link-dialog {
        margin-top: 10px;
        padding: 12px;
        border: 1px solid var(--gray-light-02);
        border-radius: 4px;
        background-color: #f9f9f9;
        
        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--gray-light-02);
            border-radius: 4px;
            font-size: 14px;
            margin-bottom: 10px;
            
            &:focus {
                outline: none;
                border-color: var(--blu);
            }
        }
        
        .link-dialog-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            
            .btn-link {
                padding: 6px 16px;
                border: 1px solid var(--gray-light-02);
                border-radius: 4px;
                background-color: white;
                cursor: pointer;
                font-size: 14px;
                
                &:hover {
                    background-color: var(--blu-light-03);
                    border-color: var(--blu);
                }
            }
        }
    }
    
    .color-control-group {
        display: flex;
        align-items: center;
        gap: 12px;
        
        .color-swatch-wrapper {
            .color-swatch {
                width: 40px;
                height: 40px;
                border: 1px solid var(--gray-light-02);
                border-radius: 4px;
                cursor: pointer;
                padding: 0;
                
                &::-webkit-color-swatch-wrapper {
                    padding: 0;
                }
                
                &::-webkit-color-swatch {
                    border: none;
                    border-radius: 3px;
                }
            }
        }
        
        .slider-wrapper {
            flex: 1;
            
            .opacity-slider {
                width: 100%;
                height: 4px;
                border-radius: 2px;
                background: linear-gradient(to right, #e0e0e0 0%, var(--blu) 100%);
                outline: none;
                -webkit-appearance: none;
                appearance: none;
                
                &::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 16px;
                    height: 16px;
                    border-radius: 50%;
                    background: var(--blu);
                    cursor: pointer;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                }
                
                &::-moz-range-thumb {
                    width: 16px;
                    height: 16px;
                    border-radius: 50%;
                    background: var(--blu);
                    cursor: pointer;
                    border: none;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                }
            }
        }
        
        .opacity-input {
            width: 50px;
            padding: 6px 8px;
            border: 1px solid var(--gray-light-02);
            border-radius: 4px;
            font-size: 12px;
            text-align: center;
            background-color: #f9f9f9;
            
            // Nasconde le freccette per input type="number"
            &[type="number"] {
                appearance: textfield;
                -moz-appearance: textfield;
                
                &::-webkit-outer-spin-button,
                &::-webkit-inner-spin-button {
                    -webkit-appearance: none;
                    margin: 0;
                }
            }
            
            &:focus {
                outline: none;
                border-color: var(--blu);
            }
        }
        
        .opacity-percent {
            font-size: 12px;
            color: var(--gray-dark);
        }
    }
}

// Background Section
.background-section {
    .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
        
        .section-title {
            margin: 0;
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-dark);
        }
        
        .collapse-icon {
            width: 18px;
            height: 18px;
            color: var(--gray-dark);
            cursor: pointer;
        }
    }
    
    .color-control-group {
        display: flex;
        align-items: center;
        gap: 12px;
        
        .color-swatch-wrapper {
            .color-swatch {
                width: 40px;
                height: 40px;
                border: 1px solid var(--gray-light-02);
                border-radius: 4px;
                cursor: pointer;
                padding: 0;
                
                &::-webkit-color-swatch-wrapper {
                    padding: 0;
                }
                
                &::-webkit-color-swatch {
                    border: none;
                    border-radius: 3px;
                }
            }
        }
        
        .slider-wrapper {
            flex: 1;
            
            .opacity-slider {
                width: 100%;
                height: 4px;
                border-radius: 2px;
                background: linear-gradient(to right, #e0e0e0 0%, var(--blu) 100%);
                outline: none;
                -webkit-appearance: none;
                appearance: none;
                
                &::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 16px;
                    height: 16px;
                    border-radius: 50%;
                    background: var(--blu);
                    cursor: pointer;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                }
                
                &::-moz-range-thumb {
                    width: 16px;
                    height: 16px;
                    border-radius: 50%;
                    background: var(--blu);
                    cursor: pointer;
                    border: none;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                }
            }
        }
        
        .opacity-input {
            width: 50px;
            padding: 6px 8px;
            border: 1px solid var(--gray-light-02);
            border-radius: 4px;
            font-size: 12px;
            text-align: center;
            background-color: #f9f9f9;
            
            // Nasconde le freccette per input type="number"
            &[type="number"] {
                appearance: textfield;
                -moz-appearance: textfield;
                
                &::-webkit-outer-spin-button,
                &::-webkit-inner-spin-button {
                    -webkit-appearance: none;
                    margin: 0;
                }
            }
            
            &:focus {
                outline: none;
                border-color: var(--blu);
            }
        }
        
        .opacity-percent {
            font-size: 12px;
            color: var(--gray-dark);
        }
        
        .field-box {
            margin-bottom: 15px;
            
            .disable-input-message-section {
                display: flex;
                align-items: center;
                margin-bottom: 8px;
                
                ::ng-deep .mat-checkbox {
                    .mat-checkbox-label {
                        font-size: 14px;
                        color: var(--gray-dark);
                    }
                }
            }
        }
    }
}

// Titolo rect: stessa grafica di .rich-text-editor-section (condivide la classe); altezza editor 80px
.title-section.rich-text-editor-section ::ng-deep .ql-editor {
    min-height: 80px;
}

.form-group {
    margin-bottom: 20px;
    
    label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
        font-weight: 500;
        color: var(--gray-dark);
    }
    
    .form-control {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid var(--gray-light-02);
        border-radius: 4px;
        font-size: 14px;
        
        &.color-input {
            height: 40px;
            cursor: pointer;
        }
        
        &:focus {
            outline: none;
            border-color: var(--blu);
        }
    }
    
    textarea.form-control {
        resize: vertical;
        min-height: 100px;
    }
}

.position-inputs,
.size-inputs {
    display: flex;
    gap: 15px;
    
    .input-group {
        flex: 1;
        
        label {
            display: block;
            margin-bottom: 8px;
            font-size: 12px;
            font-weight: 400;
            color: var(--gray-dark);
        }
        
        .form-control {
            width: 100%;
        }
    }
}

.cds-blue-button {
    background-color: var(--blu);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    
    &:hover {
        background-color: var(--blu-dark);
    }
}
